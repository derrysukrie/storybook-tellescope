import { Meta, Canvas, ArgTypes, Story } from "@storybook/addon-docs/blocks"
import { SentForm } from './SentForm';
import * as SentFormStories from './SentForm.stories.tsx';

<Meta of={SentFormStories} />

# SentForm

A multi-step form component that renders different step types based on configuration.

## Basic Usage

```tsx
import { SentForm } from './SentForm';

function MyForm() {
  return (
    <SentForm
      steps={[
        {
          type: "intro",
          id: "welcome",
        },
        {
          type: "text",
          id: "name",
          title: "What's your name?",
          helperText: "Enter your full name",
        },
        {
          type: "email",
          id: "email",
          title: "Email address",
          helperText: "We'll use this to contact you",
        },
      ]}
      onFormDataChange={(formData) => {
        console.log("Form data updated:", formData);
      }}
      onComplete={(formData) => {
        console.log("Form completed:", formData);
      }}
    />
  );
}
```

## Props

| Prop | Type | Required | Default | Description |
|------|------|----------|---------|-------------|
| `steps` | `StepConfig[]` | ✅ | - | Array of step configurations |
| `onComplete` | `(data: FormData) => void` | ❌ | - | Callback when form is completed |
| `onFormDataChange` | `(formData: FormData) => void` | ❌ | - | Callback when form data changes |
| `debounceDelay` | `number` | ❌ | `300` | Debounce delay in milliseconds |

## Step Types

### Intro Step
Welcome screen with checkbox acceptance.

```tsx
{
  type: "intro",
  id: "welcome",
  title?: string,
  subtitle?: string,
}
```

### Description Step
Displays explanatory text.

```tsx
{
  type: "description",
  id: "description",
  description: "Let's get to know you better...",
}
```

### Text Input Steps

#### Basic Text
```tsx
{
  type: "text",
  id: "name",
  title?: string,
  placeholder?: string,
  helperText?: string,
}
```

#### Email
```tsx
{
  type: "email",
  id: "email",
  title?: string,
  placeholder?: string,
  helperText?: string,
}
```

#### Phone
```tsx
{
  type: "phone",
  id: "phone",
  title?: string,
  placeholder?: string,
  helperText?: string,
}
```

#### Number
```tsx
{
  type: "number",
  id: "age",
  title?: string,
  placeholder?: string,
  helperText?: string,
}
```

#### Long Text
```tsx
{
  type: "longText",
  id: "description",
  title?: string,
  placeholder?: string,
  helperText?: string,
}
```

### Date & Time Steps

#### Date
```tsx
{
  type: "date",
  id: "birthdate",
  title?: string,
  placeholder?: string,
  helperText?: string,
}
```

#### DateTime
```tsx
{
  type: "dateTime",
  id: "appointment",
  title?: string,
  placeholder?: string,
  helperText?: string,
}
```

#### Time
```tsx
{
  type: "time",
  id: "preferred_time",
}
```

### Selection Steps

#### Single Select
```tsx
{
  type: "select",
  id: "location",
  title: "Where are you located?",
  options: [
    { value: "us", label: "United States" },
    { value: "ca", label: "Canada" },
  ],
  placeholder?: string,
  helperText?: string,
}
```

#### Multi Select
```tsx
{
  type: "multiSelect",
  id: "interests",
  title: "What are your interests?",
  options: [
    { value: "tech", label: "Technology" },
    { value: "health", label: "Healthcare" },
  ],
  placeholder?: string,
  helperText?: string,
}
```

#### Choice (Radio Buttons)
```tsx
{
  type: "choice",
  id: "contact_preference",
  label: "How would you prefer to be contacted?",
  options: [
    { id: "email", label: "Email", value: "email" },
    { id: "phone", label: "Phone call", value: "phone" },
  ],
  helperText?: string,
}
```

#### Checkbox
```tsx
{
  type: "checkbox",
  id: "preferences",
  title: "What are your preferences?",
  options: [
    { label: "Receive newsletter", value: "newsletter" },
    { label: "Product updates", value: "updates" },
  ],
  helperText: "Select all that apply",
}
```

### Special Steps

#### File Upload
```tsx
{
  type: "fileUpload",
  id: "documents",
}
```

#### Address
```tsx
{
  type: "address",
  id: "home_address",
}
```

#### Insurance
```tsx
{
  type: "insurance",
  id: "insurance_info",
}
```

#### Signature Consent
```tsx
{
  type: "signatureConsent",
  id: "consent",
}
```

### Rating & Ranking

#### Rating
```tsx
{
  type: "rating",
  id: "satisfaction",
  min: 0,
  max: 10,
  step: 1,
  shiftStep: 1,
  marks: true,
}
```

#### Ranking
```tsx
{
  type: "ranking",
  id: "priorities",
  items: [
    { id: "1", text: "Item 1" },
    { id: "2", text: "Item 2" },
    { id: "3", text: "Item 3" },
  ],
}
```

### Questions Group
Multiple related questions in one step.

```tsx
{
  type: "questionsGroup",
  id: "personal_info",
  title: "Personal Information",
  description: "Please provide your basic information",
  questions: [
    {
      label: "What's your name?",
      hint: "Enter your full name",
      fieldKey: "name",
      hiddenLabel?: boolean,
    },
    {
      label: "What's your email?",
      hint: "Enter your email address",
      fieldKey: "email",
      hiddenLabel?: boolean,
    },
  ],
}
```

## Form Data Structure

Form data is collected as key-value pairs where keys are step IDs:

```tsx
{
  name: "John Doe",
  email: "john@example.com",
  location: "us",
  interests: ["tech", "health"],
  documents: [/* file upload data */],
  personal_info_name: "John", // Questions group data
  personal_info_email: "john@example.com",
}
```

## Validation

- **Intro Step**: Requires checkbox to be checked
- **Text Inputs**: Requires non-empty content
- **Select/Choice**: Requires an option to be selected
- **Multi-Select/Checkbox**: Requires at least one option selected
- **File Upload**: Requires at least one file
- **Questions Group**: Requires all questions to have data

The CONTINUE button is automatically disabled until the current step is valid.

## Examples

### Simple Contact Form
```tsx
const steps = [
  { type: "intro", id: "welcome" },
  { type: "text", id: "name", title: "What's your name?" },
  { type: "email", id: "email", title: "Email address" },
  { type: "phone", id: "phone", title: "Phone number" },
];
```

### Survey Form
```tsx
const steps = [
  { type: "intro", id: "welcome" },
  { type: "description", id: "intro", description: "Help us improve our service" },
  { type: "select", id: "age_group", title: "Age group", options: ageOptions },
  { type: "multiSelect", id: "interests", title: "Interests", options: interestOptions },
  { type: "rating", id: "satisfaction", min: 1, max: 5, step: 1, shiftStep: 1, marks: true },
];
```

### Complex Form
```tsx
const steps = [
  { type: "intro", id: "welcome" },
  { type: "questionsGroup", id: "personal", title: "Personal Info", questions: personalQuestions },
  { type: "address", id: "address" },
  { type: "date", id: "birthdate", title: "Date of birth" },
  { type: "fileUpload", id: "documents" },
  { type: "signatureConsent", id: "consent" },
];
```